/* PubSub - v0.1.0 - 2012-11-11
* Copyright (c) 2012 Adam Zamozniewicz <zamozniewicz@gmail.com>
* Released under the MIT License */
Array.prototype.forEach||(Array.prototype.forEach=function(e,t){"use strict";for(var n=0,r=this.length;n<r;++n)e.call(t,this[n],n,this)}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError;var r=[],i=arguments[1];for(var s=0;s<n;s++)if(s in t){var o=t[s];e.call(i,o,s,t)&&r.push(o)}return r}),function(e){"use strict";var t=typeof window!="undefined"&&window||this,n=typeof module=="object"&&typeof exports=="object",r=typeof define=="function"&&define.amd;n?module.exports=e():r?define(e):t.pubsub=e()}(function(e){"use strict";var t={},n={},r=0;return n.subscribe=function(e,n){if(typeof e!="string")throw new Error("Provide a valid message to subscribe to.");var i=r+1;return r=i,t[e]=t[e]||[],t[e].push({token:i,callback:n}),i},n.unsubscribe=function(e,n){if(typeof e!="string")throw new Error("Provide a valid message to unsubscribe.");if(!t.hasOwnProperty(e))return;var r=!1,i=!1;if(typeof n=="function")r=!0;else{if(typeof n!="number")throw new Error("Provide a valid callback or token of a subscription to unsubscribe.");i=!0}t[e]=t[e].filter(function(e){if(r)return e.callback!==n;if(i)return e.token!==n})},n.publish=function(e,n){if(typeof e!="string")throw new Error("Provide a valid topic name to publish.");if(!t[e])return;t[e].forEach(function(e){e.callback(n)})},n});